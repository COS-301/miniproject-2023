<ng-container *ngIf="profile$ | async as profile; else loading">
  <form
    [formGroup]="personalDetailsForm"
    ngxsForm="profile.personalDetailsForm"
    (submit)="updatePersonalDetails()">
    <ion-card *ngIf="profile.personalDetails as personalDetails">
      <ion-card-header>
        <ion-card-title class="ion-align-items-center">
          Personal Details
          <ion-icon
            *ngIf="personalDetails.status == 'Incomplete'"
            color="danger"
            name="alert-circle-outline"></ion-icon>
          <ion-icon
            *ngIf="personalDetails.status == 'Complete'"
            color="success"
            name="checkmark-circle-outline"></ion-icon>
        </ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-list>
          <ion-item class="ion-no-padding">
            <ion-label position="floating" class="required edit-profile-text">Age</ion-label>
            <ion-input
              type="text"
              minlength="4"
              maxlength="64"
              required="true"
              [value]="personalDetails.age"
              formControlName="age"
              placeholder="Enter age"></ion-input>
          </ion-item>
          <ion-text
            *ngIf="age?.invalid && (age?.dirty || age?.touched)"
            class="ion-padding-start"
            color="danger">
            <small>{{ ageError }}</small>
          </ion-text>
          <ion-item class="ion-no-padding">
            <ion-label position="floating" class="required edit-profile-text">Gender</ion-label>
            <ion-input
              type="text"
              minlength="4"
              maxlength="64"
              required="true"
              [value]="personalDetails.gender"
              formControlName="gender"
              placeholder="Enter gender"></ion-input>
          </ion-item>
          <ion-text
            *ngIf="gender?.invalid && (gender?.dirty || gender?.touched)"
            class="ion-padding-start"
            color="danger">
            <small>{{ genderError }}</small>
          </ion-text>
          <ion-item class="ion-no-padding">
            <ion-label position="floating" class="required edit-profile-text">
              Ethnicity
            </ion-label>
            <ion-input
              type="text"
              minlength="4"
              maxlength="64"
              required="true"
              [value]="personalDetails.ethnicity"
              formControlName="ethnicity"
              placeholder="Enter ethnicity"></ion-input>
          </ion-item>
          <ion-text
            *ngIf="
              ethnicity?.invalid && (ethnicity?.dirty || ethnicity?.touched)
            "
            class="ion-padding-start"
            color="danger">
            <small>{{ ethnicityError }}</small>
          </ion-text>
        </ion-list>
      </ion-card-content>
      <ion-row class="ion-align-items-center">
        <ion-col size="12" class="ion-text-center">
          <ion-button fill="clear" class="edit-profile-button ion-margin-bottom" type="submit">Save</ion-button>
        </ion-col>
      </ion-row>
    </ion-card>
  </form>
</ng-container>
<ng-template #loading>
  <ion-grid>
    <ion-row>
      <ion-col>
        <ngx-skeleton-loader
          count="1"
          [theme]="{ height: '150px' }"
          appearance="line"></ngx-skeleton-loader>
      </ion-col>
    </ion-row>
  </ion-grid>
</ng-template>
