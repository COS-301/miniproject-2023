<ion-content ngClass="view-page" color="dark">
  <ion-menu contentId="main-content" side="end">
    <ion-content ngClass="menu-sidebar" class="ion-padding">
      <ion-header ngClass="menu-heading">
        <ion-text ngClass="menu-heading-text">Menu</ion-text>
        <ion-menu-button ngClass="btn-menu-exit" (click)="toggleMenuStatus()">
          <ion-icon name="close" ngClass="btn-menu-exit-text"></ion-icon>
        </ion-menu-button>
      </ion-header>
      <ion-list ngClass="menu-list">
        <ion-nav-link [routerLink]="['Dashboard']">
          <ion-item ngClass="menu-list-item" lines="none">
            <ion-icon color="dark" slot="start" name="home"></ion-icon>
            <ion-text ngClass="menu-list-item-text">Dashboard</ion-text>
          </ion-item>
        </ion-nav-link>
        <ion-nav-link [routerLink]="['profile']" [queryParams]="{ from: 'profile-view'}">
          <ion-item ngClass="menu-list-item" lines="none">
            <ion-icon slot="start" name="settings"></ion-icon>
            <ion-text ngClass="menu-list-item-text">Profile Settings</ion-text>
          </ion-item>
        </ion-nav-link>
        <ion-item ngClass="menu-list-item" lines="none">
          <ion-icon slot="start" name="cloud-upload"></ion-icon>
          <ion-text (click)="revive()" ngClass="menu-list-item-text">Revive Memory</ion-text>
        </ion-item>
        <ion-item ngClass="menu-list-item" lines="none">
          <ion-icon slot="start" name="create"></ion-icon>
          <ion-text (click)="editProfilePhoto()" ngClass="menu-list-item-text">Edit profile photo</ion-text>
        </ion-item>
      </ion-list>
    </ion-content>
  </ion-menu>
  <div class="ion-page" id="main-content">
    <ion-toolbar ngClass="top-bar">
      <ion-buttons (click)="addMemory()" slot="start">
        <ion-icon name="add" color="light" ngClass="add-btn"></ion-icon>
      </ion-buttons>
      <ion-buttons slot="end" (click)="toggleMenuStatus()">
        <ion-menu-button ngClass="burger-menu" auto-hide="false"></ion-menu-button>
      </ion-buttons>
      <ion-title ngClass="title">Memory Lane</ion-title>
    </ion-toolbar>
  </div>

  <ion-grid ngClass="heading-grid">
    <ion-row ngClass="heading-grid-row" class="ion-text-center">
      <ion-col ngClass="heading-grid-row-col1">
        <ion-text ngClass="heading-grid-row-col1-title">Friends</ion-text><br />
        <ion-text ngClass="friend-memories-count">100</ion-text>
      </ion-col>
      <ion-col ngClass="heading-grid-row-col2">
        <ion-avatar ngClass="user-profile-img">
          <ion-img [src]="profileImage.profileImageUrl"></ion-img><br />
        </ion-avatar>
        <ion-text ngClass="username">@username</ion-text>
      </ion-col>
      <ion-col ngClass="heading-grid-row-col3">
        <ion-text ngClass="heading-grid-row-col3-title">Memories</ion-text><br />
        <div *ngIf="profileView$ | async as profile">
          <ion-text ngClass="friend-memories-count">{{getMemoriesLength()}}</ion-text>
        </div>
      </ion-col>
    </ion-row>
    <ion-row ngClass="account-time">
      <ion-text ngClass="account-time-text">22h:52m:00s</ion-text>
    </ion-row>
  </ion-grid>

  <ion-list ngClass="memory-list">
    <ion-card *ngFor="let memory of Memories" [ngClass]="{ 'memory-card': !showExpandedView, 'memory-card-expanded': showExpandedView }" color="none">
      <img *ngIf="!showExpandedView" ngClass="memory-img" style="background-image: url('{{ memory.imgUrl }}');" />
      <ion-card-header>
        <div
          [ngClass]="{ 'memory-avatar-username': !showExpandedView, 'memory-avatar-username-expanded': showExpandedView }"
        >
          <ion-avatar slot="start">
            <img
              src="{{ memory.profileImgUrl }}"
              [ngClass]="{
                'memory-card-profileImage': !showExpandedView,
                'memory-card-profileImage-expanded': showExpandedView
              }"
            />
          </ion-avatar>
          <ion-card-title
            [ngClass]="{ 'memory-card-username': !showExpandedView, 'memory-card-username-expanded': showExpandedView }"
            >{{ memory.username }}</ion-card-title
          >
          <ion-text
            [ngClass]="{ 'memory-card-time-ago': !showExpandedView, 'memory-card-time-ago-expanded': showExpandedView }"
            >{{ calculateHowLongAgo(memory.created) }}</ion-text
          >
        </div>
      </ion-card-header>
      <ion-card-content scroll-y="false" [ngClass]="{ 'ion-card-content-expanded': showExpandedView }">
        <ion-card-title *ngIf="!showExpandedView" ngClass="memory-card-title" (click)="changeMemoryView(memory.userId, memory.memoryId)">{{ memory.title }}</ion-card-title>
        <ion-img *ngIf="showExpandedView" ngClass="memory-img-expanded" src="{{ memory.imgUrl }}"></ion-img>
        <h4 *ngIf="showExpandedView" ngClass="memory-card-title-expanded">{{ memory.title }}</h4>
        <p [ngClass]="{ 'memory-card-desc': !showExpandedView, 'memory-card-desc-expanded': showExpandedView }" (click)="changeMemoryView(memory.userId, memory.memoryId)">
          {{ memory.description }}
        </p>
        <ion-text *ngIf="!showExpandedView" class="ion-padding-top" ngClass="memory-date">{{
          convertTimePostedToDate(memory.created)
        }}</ion-text>
        <span [ngClass]="{'span-post-timer': !showExpandedView, 'span-post-timer-expanded':showExpandedView}">
          <ion-buttons slot="start">
            <ion-text color="light" ngClass="btn-add-time">+</ion-text>
          </ion-buttons>
          <p ngClass="memory-card-timer">0d:3h:0min</p>
        </span>
        <div *ngIf="showExpandedView" class="commentIcon-viewAll">
          <div class="memory-comment-and-icon">
            <ion-icon ngClass="memory-comment-icon" name="chatbox-outline"></ion-icon>
            <ion-label ngClass="memory-comment-text">Comment</ion-label>
          </div>
          <ion-text ngClass="comment-viewAll" (click)="openViewedComments()">View all comments <b>{{ getCommentsLength() }}</b></ion-text>
        </div>
        <div *ngIf="showExpandedView && memory" ngClass="comment-profileImg-username">
          <ion-avatar ngClass="memory-avatar-expanded">
            <img src="{{ getFirstCommentProfileImage() }}" ngClass="memory-comment-profileImg" />
          </ion-avatar>
          <div ngClass="memory-username-and-comment">
            <ion-text ngClass="memory-comment-username">{{ getFirstCommentUsername() }}</ion-text>
            <ion-text ngClass="memory-comment-usercomment">{{ getFirstCommentText() }}</ion-text>
          </div>
        </div>
        <ion-text (click)="changeMemoryView(memory.userId, memory.memoryId)" ngClass="memory-show-more">{{
          !showExpandedView ? 'Show More' : 'Show Less'
        }}</ion-text>
      </ion-card-content>
    </ion-card>
    
  </ion-list>
</ion-content> 